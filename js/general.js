jQuery(document).ready(function ($) {
  $('label[for="_custom_product_storeeo_price"]').addClass("btn");

  // Example usage:
  const user = getCookieValue("storeeo_u");

  const urlParams = new URLSearchParams(window.location.search);
  const page = urlParams.get("page");

  if (!user && page.includes("storeeo")) {
    $("body").prepend(`
  ]      <div class="popover-back"></div>
         <div class="popover">
         <div class="title">Connect Storeeo to your online store</div>
         <div class="description">Storeeo helps sellers promote their products on another Woocomerce platforms</div>

         <a href="http://localhost:3000/" target="_blank">
          <div class="box">
              <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="80px" height="80px" viewBox="0 0 80 80" version="1.1" class="injected-svg" data-src="/svg/woo.svg" role="img">
                    <title>Artboard Copy</title>
                    <g id="Artboard-Copy" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                        <g id="woocommerce" transform="translate(1.000000, 17.000000)" fill-rule="nonzero">
                            <path d="M7.23900621,0 L70.7292356,0 C74.747458,0 78,3.29248286 78,7.36004856 L78,31.8928241 C78,35.9603898 74.747458,39.2528727 70.7292356,39.2528727 L47.9608322,39.2528727 L51.0860147,47 L37.3418538,39.2528727 L7.27069373,39.2528727 C3.25277603,39.2528727 0,35.9603898 0,31.8928241 L0,7.36004856 C-0.0317581937,3.32486793 3.22047913,0 7.23900621,0 Z" id="Path-19" fill="#9B5C8F"></path>
                            <path d="M3.55962468,8.2694021 C4.01488513,7.68127617 4.69761958,7.37204919 5.60814048,7.31020379 C7.26670086,7.18621566 8.20971804,7.92865776 8.43719204,9.5378274 C9.44520179,16.004834 10.5507004,21.4817196 11.7211916,25.9681869 L18.8422524,13.0653937 C19.4928031,11.8894391 20.3058351,11.2706878 21.2813486,11.2088424 C22.7121225,11.1160744 23.5898346,11.9822072 23.9476062,13.8078358 C24.7606383,17.9229333 25.8011443,21.4195769 27.0366281,24.3899399 C27.8821564,16.5308172 29.3129303,10.8683954 31.3289498,7.37204919 C31.8163941,6.50561897 32.5319373,6.07240386 33.4749545,6.01026113 C34.222994,5.94871306 34.9057284,6.16517195 35.5234703,6.62930976 C36.1412122,7.09344757 36.4664875,7.68127617 36.53148,8.3930929 C36.5639763,8.9499988 36.4664875,9.41413661 36.2065172,9.87827442 C34.9382247,12.1061954 33.8974062,15.8502205 33.0521903,21.0482072 C32.2394707,26.0918777 31.9466917,30.0217364 32.1416694,32.8374859 C32.2069745,33.6105534 32.0766769,34.2914474 31.751714,34.8795733 C31.3611337,35.56017 30.7762005,35.9315398 30.0281611,35.9933851 C29.1826327,36.0552305 28.3049206,35.6841582 27.4593922,34.8486506 C24.435363,31.908913 22.0290756,27.5152138 20.2733388,21.6672558 C18.159518,25.6277399 16.5987589,28.5981029 15.5907492,30.5783449 C13.6722185,34.0749885 12.0464669,35.8696944 10.6806855,35.9624625 C9.80266092,36.0243078 9.05493391,35.3124911 8.40469575,33.8276069 C6.74644784,29.7740574 4.95790232,21.9455601 3.03968413,10.3424122 C2.90938653,9.5378274 3.10436423,8.82601067 3.55962468,8.2694021 L3.55962468,8.2694021 Z M73.4378856,13.1272391 C72.2673944,11.1779197 70.5438414,10.0022625 68.2353554,9.5378274 C67.617301,9.41413661 67.0323679,9.35229121 66.4793061,9.35229121 C63.357788,9.35229121 60.8215155,10.8993181 58.8379923,13.9936693 C57.1469356,16.6235853 56.3017197,19.532103 56.3017197,22.7192222 C56.3017197,25.1017567 56.8219727,27.1438441 57.8624788,28.8457818 C59.03297,30.7951012 60.7565229,31.9707584 63.065009,32.4348962 C63.6827509,32.5588843 64.2679964,32.6207297 64.8210582,32.6207297 C67.9750726,32.6207297 70.5113451,31.0737028 72.4623721,27.9793516 C74.1531163,25.3182156 74.9986446,22.4096979 74.9986446,19.222876 C75.0311409,16.8094188 74.4783916,14.7979568 73.4378856,13.1272391 L73.4378856,13.1272391 Z M69.340854,21.6981785 C68.8855935,23.7402659 68.0725615,25.2563702 66.8692615,26.2774139 C65.9265568,27.0819987 65.0485322,27.4221484 64.2358126,27.2675349 C63.4552769,27.1129214 62.8047262,26.4632474 62.317282,25.2563702 C61.9267016,24.2971718 61.7320364,23.3379735 61.7320364,22.4406206 C61.7320364,21.6672558 61.7970289,20.8935937 61.9595104,20.1820743 C62.2522894,18.9133517 62.8050387,17.6755517 63.6827509,16.4998945 C64.7560656,14.983493 65.8940605,14.365039 67.0645517,14.5814979 C67.8450875,14.7361114 68.4956381,15.3860827 68.9830824,16.5926626 C69.3733503,17.5518609 69.568328,18.5110593 69.568328,19.4084122 C69.568328,20.212997 69.5033354,20.9863618 69.340854,21.6978812 L69.340854,21.6981785 Z M53.0824003,13.1272391 C51.9119091,11.1779197 50.1558599,10.0022625 47.8798701,9.5378274 C47.2621282,9.41413661 46.6768826,9.35229121 46.1238209,9.35229121 C43.0023027,9.35229121 40.4660302,10.8993181 38.482507,13.9936693 C36.7917628,16.6235853 35.9462344,19.532103 35.9462344,22.7192222 C35.9462344,25.1017567 36.4664875,27.1438441 37.5069935,28.8457818 C38.6774847,30.7951012 40.4010376,31.9707584 42.7095237,32.4348962 C43.327578,32.5588843 43.9125112,32.6207297 44.4655729,32.6207297 C47.6195873,32.6207297 50.1558599,31.0737028 52.1068868,27.9793516 C53.7979435,25.3182156 54.6431593,22.4096979 54.6431593,19.222876 C54.6431593,16.8094188 54.1229063,14.7979568 53.0824003,13.1272391 L53.0824003,13.1272391 Z M48.9528724,21.6981785 C48.497612,23.7402659 47.6845799,25.2563702 46.4815924,26.2774139 C45.5385753,27.0819987 44.6605506,27.4221484 43.8475186,27.2675349 C43.0672953,27.1129214 42.4170571,26.4632474 41.9289879,25.2563702 C41.5390325,24.2971718 41.3440548,23.3379735 41.3440548,22.4406206 C41.3440548,21.6672558 41.4090474,20.8935937 41.5715288,20.1820743 C41.8643078,18.9133517 42.4170571,17.6755517 43.2950818,16.4998945 C44.3680841,14.983493 45.506079,14.365039 46.6765702,14.5814979 C47.4571059,14.7361114 48.1076565,15.3860827 48.5951008,16.5926626 C48.9856812,17.5518609 49.1803464,18.5110593 49.1803464,19.4084122 C49.2131552,20.212997 49.1153538,20.9863618 48.9528724,21.6978812 L48.9528724,21.6981785 Z" id="Shape-20" fill="#FFFFFF"></path>
                        </g>
                    </g>
                </svg>
              <div>Connect Your Woocommerce</div>
          </div>
         </a>
       </div>
    `);
  } else {
    storeUserDataToSession(user);
    $(".wp-heading-inline").after(`
    <div class="storeeo-user-wrapper flex">
      <img src=${user.photo} />
      <div class="storeeo-name">${user.first_name}</div>
    </div>
  `);
  }

  function storeUserDataToSession(user) {
    $.ajax({
      type: "POST",
      url: ajax_call.storeUserDataToSession,
      data: {
        user: user,
      },
      success: function (response) {
        console.log(response);
      },
    });
  }
});
